# Robot Frameworkファイルへのコメント追加プロンプト

## プロンプト

以下の手順で、Robot Frameworkファイル（.robot）とTypeファイル（.type）にコメントとタグを追加してください。

## ファイル形式の判定

Robot Frameworkファイルには2つの形式があります：

1. **旧形式（XML形式）**：`<object class="Transition">`や`<object class="Group">`などのXML要素でステップが定義されている
2. **新形式（Robot2形式）**：`<prologue>`内はXML、`<body>`内はJSON形式でステップが定義されている（`<object class="Robot2">`）

作業を開始する前に、ファイルの形式を確認してください。

## 作業の全体フロー

1. ファイル全体を読み込んで構造を理解する（XML形式かRobot2形式かを判定）
2. Typeファイル（.type）の各属性にコメントを追加する
3. 各ステップ（TransitionステップまたはJSON形式のステップ）にコメントを追加する
4. 各Groupステップ（またはBlockステップ）にコメントを追加する
5. ロボット全体のコメントを追加する
6. ロボットタグを追加する
7. リンターエラーを確認して修正する

---

## 1. Typeファイル（.type）へのコメント追加

### 作業内容
Typeファイル内の各`Attribute`要素に`comment`プロパティを追加する。

### 具体的な手順
1. Typeファイルを開く
2. `<property name="attributes" class="kapow.robot.common.domain.Attributes">`内の各`Attribute`要素を探す
3. 各`Attribute`要素内に`<property name="comment" class="String">コメント内容</property>`を追加する
4. コメント内容は、その属性が何を格納するかを日本語で説明する

### 追加位置の例
**修正前：**
```xml
<object class="kapow.robot.common.domain.Attribute" serializationversion="1">
  <property name="name" class="String">ICD_10</property>
  <property name="type" class="kapow.robot.plugin.common.domain.StringAttributeType"/>
  <property name="recordFieldType" class="String">Text</property>
</object>
```

**修正後：**
```xml
<object class="kapow.robot.common.domain.Attribute" serializationversion="1">
  <property name="name" class="String">ICD_10</property>
  <property name="type" class="kapow.robot.plugin.common.domain.StringAttributeType"/>
  <property name="recordFieldType" class="String">Text</property>
  <property name="comment" class="String">ICD-10コード（国際疾病分類第10版のコード）を格納する</property>
</object>
```

### チェックリスト
- [ ] すべての`Attribute`要素に`comment`プロパティが追加されている
- [ ] コメントは日本語で記載されている
- [ ] コメントは属性の用途を明確に説明している
- [ ] XMLの形式が正しい（閉じタグがある）

---

## 2. 各ステップ（アクションステップ）へのコメント追加

### 作業内容
各ステップの`comment`プロパティに、そのステップが行う処理内容を日本語で記載する。

### ファイル形式による手順の違い

#### 旧形式（XML形式）の場合

1. ファイル内のすべての`<object class="Transition"`要素を探す
2. 各`Transition`要素内の`<property name="comment">`を確認する
3. `<null/>`になっている場合は、`<property name="comment" class="String">コメント内容</property>`に置き換える
4. 既にコメントがある場合は、そのまま残す（上書きしない）
5. コメント内容は、ステップ名（`<property name="name">`）と処理内容（`<property name="stepAction">`）から判断する

#### 新形式（Robot2形式、JSON body形式）の場合

1. `<body>`タグ内のJSONを解析する
2. `"gizmo"` → `"block"` → `"steps"`配列内の各ステップを探す
3. 各ステップの`"comment"` → `"gizmo"` → `"comment"` → `"string"`を確認する
4. 空文字列（`"string": ""`）になっている場合は、適切なコメント内容に置き換える
5. 既にコメントがある場合は、そのまま残す（上書きしない）
6. コメント内容は、ステップ名（`"name"` → `"gizmo"` → `"customName"` → `"string"`）とステップタイプ（`"meta"` → `"className"`）から判断する

### 修正例

#### 旧形式（XML形式）の場合

**修正前：**
```xml
<property name="comment">
  <null/>
</property>
```

**修正後（変数からファイルパスを取得する場合）：**
```xml
<property name="comment" class="String">変数「input.対象Excelのパス」からファイルパスを取得してExcelファイルを読み込む</property>
```

**修正後（ファイルパスが直接指定されている場合）：**
```xml
<property name="comment" class="String">ファイルパス「C:\Users\user\data.xlsx」からExcelファイルを読み込む（ファイルパスは直接ハードコードされている）</property>
```

#### 新形式（Robot2形式、JSON body形式）の場合

**修正前：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "" }
  }
}
```

**修正後（変数からURLを取得する場合）：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "変数「患者リンク」からURLを取得してページを読み込む" }
  }
}
```

**修正後（URLが直接指定されている場合）：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "URL「https://example.com/page」を読み込む（URLは直接ハードコードされている）" }
  }
}
```

**修正後（AssignStepの場合）：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "翌月の最終日を計算して変数「翌月最終日」（Text型）に代入する" }
  }
}
```

### コメント作成のガイドライン
- ステップ名から処理内容を推測する（例：「Load Page」→「ページを読み込む」）
- 簡潔に説明する（10文字～30文字程度）
- 動詞で始める（例：「開く」「読み込む」「抽出する」「書き込む」）
- 既存のコメントスタイルを参考にする
- **変数代入ステップ（AssignVariable）の場合**：
  - どの変数に値を格納するかを明示的に記載する
  - 例：「翌月の最終日を計算して変数「翌月最終日」（Text型）に代入する」
  - 値が直接指定されている場合は、「値は直接ハードコードされている」旨を記載する
  - 変数から読み込んでいる場合は、「変数「[変数名]」から読み込む」旨を記載する
- **ファイル処理ステップ（LoadFile、WriteFileなど）の場合**：
  - ファイルパスが直接指定されている場合は、パスをコメントに記載する
  - 変数から読み込んでいる場合は、「変数「[変数名]」からファイルパスを取得する」旨を記載する
  - 例：「変数「input.対象Excelのパス」からファイルパスを取得してExcelファイルを読み込む」
  - 値が直接指定されている場合は、「ファイルパスは直接ハードコードされている」旨を記載する
- **ページ読み込みステップ（LoadPage、BrowserActionStepなど）の場合**：
  - URLが直接指定されている場合は、URLをコメントに記載する
  - 変数から読み込んでいる場合は、「変数「[変数名]」からURLを取得する」旨を記載する
  - 例：「変数「患者リンク」からURLを取得してページを読み込む」
  - 値が直接指定されている場合は、「URLは直接ハードコードされている」旨を記載する
- **待機ステップ（GuardedChoiceStepでTimeOutGuardまたはTreeStopsChangingGuardを使用している場合）の場合**：
  - 待機時間を明示的に記載する
  - 待機時間が直接指定されている場合は、「[時間]秒待機する（待機時間は直接ハードコードされている）」旨を記載する
  - 待機時間が変数から取得されている場合は、「変数「[変数名]」から待機時間を取得して[時間]秒待機する」旨を記載する
  - **TimeOutGuardを使用している場合**：
    - 例：「5秒待機する（待機時間は直接ハードコードされている）」
    - 例：「変数「待機時間」から待機時間を取得して10秒待機する」
  - **TreeStopsChangingGuardを使用している場合（ページの読み込み完了を待機する場合）**：
    - `milliseconds`フィールドの値を確認して待機時間を記載する
    - 例：「ページの読み込み完了を待機する（3秒待機、待機時間は直接ハードコードされている）」
    - 例：「ページの読み込み完了を待機する（4秒待機、待機時間は直接ハードコードされている）」
    - **重要**：`milliseconds`フィールド内の`Expression`の`comment`にも、待機時間の説明を記載する（例：「待機時間は3000ミリ秒（3秒）で直接ハードコードされている」）
  - **重要**：GuardedChoiceStepでTimeOutGuardまたはTreeStopsChangingGuardを使用している場合でも、必ずコメントを追加する（空文字列のままにしない）
- **ロボット呼び出しステップ（CallRobot2Step）の場合**：
  - 呼び出し先ロボットファイル（`robot2Name`で指定されたファイル）を読み込む
  - 呼び出し先ロボットの`<prologue>`内の`<comment>`タグから【ロボット概要】を抽出する
  - 【ロボット概要】が存在する場合は、その概要を使用する
  - 【ロボット概要】が存在しない場合は、呼び出し先ロボットファイルの内容（ステップやパラメータなど）から処理内容を推測して概要を作成する
  - コメントを改行で整形して追記する
  - 形式：
    ```
    [基本コメント]
    呼び出し先：[ロボット名]
    概要：[ロボット概要または推測した概要]
    ```
  - 例（【ロボット概要】が存在する場合）：
    ```
    HOMISシステムのリストを表示する
    呼び出し先：2_HOMIS_リスト表示
    概要：HOMISシステムの書類ページで検索条件を設定してリンク一覧を取得するロボット
    ```
  - 例（【ロボット概要】が存在しない場合）：
    ```
    HOMISシステムにログインする
    呼び出し先：2_HOMIS_ログイン
    概要：HOMISシステムのログインページを読み込み、IDとパスワードを入力してログインするロボット
    ```
- **GuardedChoiceStep内のブロック内ステップ（GuardAndBlock内のblock要素内のステップ）の場合**：
  - GuardedChoiceStepの`branches`内の各`GuardAndBlock`の`block`要素内に含まれるすべてのステップにもコメントを追加する必要がある
  - これらのステップは、条件分岐の各分岐内で実行されるステップである
  - コメントは、そのステップがどのような処理を行うかを簡潔に記載する
  - 例：`ClickWithMoveStep` → 「クリニックプルダウンをクリックする」
  - 例：`PressKeyStep` → 「Ctrl+Aキーを押して全選択する」
  - 例：`EnterTextStep` → 「変数「クリニック」からクリニック名を取得してテキスト入力する」
  - **重要**：GuardedChoiceStep内のブロック内ステップも、空文字列のままにしない（必ずコメントを追加する）

### よくあるステップ名とコメント例

#### 旧形式（XML形式）の場合
- `AssignVariable` → 「[値の説明]を計算して変数「[変数名]」に代入する」（変数から読み込む場合は「変数「[変数名]」から読み込む」、直接指定の場合は「値は直接ハードコードされている」）
- `Open Excel` → 「Excelファイルを開く」（ファイルパスが変数の場合は「変数「[変数名]」からファイルパスを取得する」、直接指定の場合は「ファイルパスは直接ハードコードされている」）
- `Load Page` → 「変数「[変数名]」からURLを取得してページを読み込む」または「URL「[URL]」を読み込む（直接ハードコード）」
- `Extract [項目名]` → 「[項目名]を抽出する」
- `Set Current Window` → 「[ウィンドウ名]にフォーカスを切り替える」
- `Insert Rows` → 「Excelシートの最後に新しい行を挿入する」
- `Set Content of Row` → 「抽出した情報をExcelの行に書き込む」
- `Return Value` → 「[変数名]を戻り値として返す」
- `Write File` → 「変数「[変数名]」からファイルパスを取得してファイルを保存する」または「ファイルパス「[パス]」に保存する（直接ハードコード）」
- `Call [ロボット名]` → 以下の形式（呼び出し先ロボットの【ロボット概要】が存在する場合）：
  ```
  [基本コメント]
  呼び出し先：[ロボット名]
  概要：[ロボット概要]
  ```

#### 新形式（Robot2形式、JSON body形式）の場合
- `AssignStep`（変数代入ステップ）→ 「[値の説明]を計算して変数「[変数名]」に代入する」（変数から読み込む場合は「変数「[変数名]」から読み込む」、直接指定の場合は「値は直接ハードコードされている」）
- `GuardedChoiceStep`（条件分岐ステップ）→ 「[条件]を確認して分岐する」またはステップ名から判断
  - **TimeOutGuardを使用している場合（待機ステップ）**：必ず「[時間]秒待機する（待機時間は直接ハードコードされている）」または「変数「[変数名]」から待機時間を取得して[時間]秒待機する」と記載する（空文字列のままにしない）
  - **TreeStopsChangingGuardを使用している場合（ページの読み込み完了を待機するステップ）**：必ず「ページの読み込み完了を待機する（[時間]秒待機、待機時間は直接ハードコードされている）」と記載する（空文字列のままにしない）。また、`milliseconds`フィールド内の`Expression`の`comment`にも待機時間の説明を記載する
- `ClickWithMoveStep`（クリックステップ）→ 「[要素名]をクリックする」または「[要素名]をダブルクリックする」（count値で判断）
- `PressKeyStep`（キープレスステップ）→ 「[キー名]キーを押す」（例：「Ctrl+Aキーを押して全選択する」「TABキーを押す」）
  - **重要**：キープレスのアクションについては「（キーは直接ハードコードされている）」は記載しない
- `EnterTextStep`（テキスト入力ステップ）→ 「変数「[変数名]」からテキストを取得して入力する」または「[テキスト]を入力する（直接ハードコード）」
- `ReturnStep`（戻り値ステップ）→ 「処理を終了して戻る」
- `ThrowStep`（例外スローステップ）→ 「[例外名]をスローする」（例：「タイムアウトエラーをスローする」）
- `BrowserActionStep`（ページ読み込みステップ）→ 「変数「[変数名]」からURLを取得してページを読み込む」または「URL「[URL]」を読み込む（直接ハードコード）」
- `ExtractStep` → 「[項目名]を抽出する」
- `WriteFileStep` → 「変数「[変数名]」からファイルパスを取得してファイルを保存する」または「ファイルパス「[パス]」に保存する（直接ハードコード）」

### チェックリスト
- [ ] すべてのステップの`comment`プロパティが空でない（旧形式：`<null/>`でない、新形式：`"string": ""`でない）
- [ ] コメントは日本語で記載されている
- [ ] コメントは処理内容を簡潔に説明している
- [ ] XML形式またはJSON形式が正しい
- [ ] AssignVariableステップには、変数名が記載されている
- [ ] ファイル処理ステップには、ファイルパスの取得方法（変数または直接指定）が記載されている
- [ ] ページ読み込みステップには、URLの取得方法（変数または直接指定）が記載されている
- [ ] 値が直接指定されている場合は、「直接ハードコードされている」旨が記載されている
- [ ] **GuardedChoiceStepでTimeOutGuardまたはTreeStopsChangingGuardを使用している待機ステップには、必ず待機時間と取得方法（変数または直接指定）が記載されている**（空文字列のままにしない）
- [ ] **TreeStopsChangingGuardを使用している場合、`milliseconds`フィールド内の`Expression`の`comment`にも待機時間の説明が記載されている**
- [ ] **GuardedChoiceStep内のブロック内ステップ（GuardAndBlock内のblock要素内のステップ）にも、必ずコメントが記載されている**（空文字列のままにしない）

---

## 3. 各Groupステップ（またはBlockステップ）へのコメント追加

### 作業内容
各`Group`ステップ（旧形式）または`Block`ステップ（新形式）の`comment`プロパティに、そのグループ内でどのような処理が行われているかを記載する。

### ファイル形式による手順の違い

#### 旧形式（XML形式）の場合

1. ファイル内のすべての`<object class="Group"`要素を探す
2. 各`Group`要素内の`<comment>`プロパティを確認する
3. `<null/>`または空の場合は、以下の形式でコメントを作成する
4. グループ内の`Transition`ステップを確認して、処理フローを理解する

#### 新形式（Robot2形式、JSON body形式）の場合

1. `<body>`タグ内のJSONを解析する
2. `"gizmo"` → `"block"`内の各`Block`要素を探す（ネストされたBlockも含む）
3. 各`Block`要素の`"comment"`プロパティを確認する（`GuardAndBlock`内の`block`要素など）
4. 空文字列（`"string": ""`）の場合は、以下の形式でコメントを作成する
5. ブロック内のステップを確認して、処理フローを理解する
6. **注意**：最上位の`Block`（`"gizmo"` → `"block"`）は通常、ロボット全体の処理フローなので、Groupコメントではなくロボット全体のコメントとして扱う

### 必須の形式（厳守）

```
*******************************************************
機能 : [グループの機能概要を1行で説明]
引数 : [引数がある場合は記載、ない場合は「なし」]
戻り値 : [戻り値がある場合は記載、ない場合は「なし」]
備考 : 
[グループ内の処理フローを詳しく説明する。複数行にわたる場合は改行して記載する。]
*******************************************************
```

### 重要な注意点
- **上段と下段のみを`*******************************************************`で囲む**
- **各行の先頭には「*」を付けない**
- 機能、引数、戻り値、備考の4項目を必ず含める
- 備考は複数行でも可

### 修正例

#### 旧形式（XML形式）の場合

**修正前：**
```xml
<comment>
  <null/>
</comment>
```

**修正後：**
```xml
<comment class="String">*******************************************************
機能 : Excelファイルの初期化
引数 : なし
戻り値 : なし
備考 : 
Excelファイルを開いて、後続の処理で使用できるようにする。
グローバル変数excelにExcelファイルの参照を設定する。
*******************************************************</comment>
```

#### 新形式（Robot2形式、JSON body形式）の場合

**修正前：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "" }
  }
}
```

**修正後：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "*******************************************************\n機能 : デスクトップ上のkintoneアイコンをダブルクリックする\n引数 : なし\n戻り値 : なし\n備考 : \nデスクトップ上のkintoneアイコンを検索し、見つかった場合はダブルクリックする。\n60秒以内に見つからない場合はタイムアウトエラーをスローする。\n*******************************************************" }
  }
}
```

**注意**：JSON形式では改行は`\n`で表現する。

### 備考欄の書き方
- グループ内の処理を時系列で説明する
- 重要な処理フローを箇条書きで記載する
- 各ステップの詳細は記載しない（概要のみ）

### チェックリスト
- [ ] すべての`Group`要素にコメントが追加されている
- [ ] 上段と下段のみが`*******************************************************`で囲まれている
- [ ] 各行の先頭に「*」が付いていない
- [ ] 機能、引数、戻り値、備考の4項目がすべて含まれている
- [ ] コメントは日本語で記載されている

---

## 4. ロボット全体のコメント追加

### 作業内容
ロボット全体のコメント領域に、すべてのステップを総括してロボットがどのような処理を行っているかを記載する。

### ファイル形式による手順の違い

#### 旧形式（XML形式）の場合

1. ファイルの`<prologue>`内の`<comment>`タグを探す
2. `<property name="comment">`要素を探す（`<prologue>`の外側、`<property name="variables">`の前後）
3. **重要**：`<property name="comment">`要素には`class="String"`属性を必ず追加する（`<property name="comment" class="String">`という形式）
4. 両方に同じ内容のコメントを追加する

#### 新形式（Robot2形式、JSON body形式）の場合

1. ファイルの`<prologue>`内の`<comment>`タグを探す（XML部分）
2. `<body>`タグ内のJSONの`"gizmo"` → `"configurations"` → `"gizmo"` → `"comment"` → `"gizmo"` → `"comment"` → `"string"`を探す
3. 両方に同じ内容のコメントを追加する
4. **注意**：`<prologue>`内の`<comment>`はXML形式、JSON内の`comment`はJSON形式で記述する

### 必須の形式（厳守）

以下の4つのセクションを必ず含める：

```
【ロボット概要】[ロボットの目的を1行で説明]                                  

【処理内容】[ロボット全体の処理概要を1行にまとめる]                          

【主な処理フロー】                                                                  
【1】[グループ名]：[グループの処理内容を簡潔に説明]                                
【2】[グループ名]：[グループの処理内容を簡潔に説明]          
    - [詳細な処理内容1]                                                  
    - [詳細な処理内容2]                      
【3】[グループ名]：[グループの処理内容を簡潔に説明]                      

【使用変数】                                                                        
- [変数名]：[変数の説明]                                
- [変数名]：[変数の説明]
```

### 重要な形式ルール
1. **見出しは【】で囲む**（例：【ロボット概要】、【処理内容】、【主な処理フロー】、【使用変数】）
2. **項目番号も【】で囲む**（例：【1】、【2】、【3】）
3. **コロンは全角コロン（：）を使用する**
4. **各行は51文字（全角半角含む）以内に収め、行末にスペースを追加して51文字に揃える**
5. **改行が表示されない環境でも視覚的に区別できるよう、セクションや項目を明確に識別できる形式にする**

### 修正例

#### 旧形式（XML形式）の場合

**修正前：**
```xml
<comment/>
```

**修正後（prologue内）：**
```xml
<comment>【ロボット概要】ICDコード一覧をウェブページから取得してExcelに出力するロボット                                  

【処理内容】ICDコード一覧ページからICD-10コード、対応コード、ICD分類名称、DPC傷病分類6桁コードを抽出し、Excelファイルに書き込んで保存する。                          

【主な処理フロー】                                                                  
【1】Gr1グループ：Excelファイルを開いて初期化する                                
【2】Gr2グループ：ウェブページからICDコード情報を取得してExcelに書き込む          
    - ICDコード一覧ページを読み込む                                                  
    - テーブル要素と行を繰り返し処理して各ICDコード情報を抽出                      
    - 抽出した情報をExcelの行に書き込む                                            
    - 抽出したICDコード情報を戻り値として返す                                        
【3】Gr3グループ：処理済みのExcelファイルを指定パスに保存する                      

【使用変数】                                                                        
- excel：Excelファイルの参照を格納するグローバル変数                                
- icdコード：ICDコード情報を格納する型変数（ICD_10、対応コード、ICD分類名称、DPC傷病分類_DPC6桁を含む）</comment>
```

**修正後（property name="comment"要素）：**
```xml
<property name="comment" class="String">【ロボット概要】ICDコード一覧をウェブページから取得してExcelに出力するロボット                                  

【処理内容】ICDコード一覧ページからICD-10コード、対応コード、ICD分類名称、DPC傷病分類6桁コードを抽出し、Excelファイルに書き込んで保存する。                          

【主な処理フロー】                                                                  
【1】Gr1グループ：Excelファイルを開いて初期化する                                
【2】Gr2グループ：ウェブページからICDコード情報を取得してExcelに書き込む          
    - ICDコード一覧ページを読み込む                                                  
    - テーブル要素と行を繰り返し処理して各ICDコード情報を抽出                      
    - 抽出した情報をExcelの行に書き込む                                            
    - 抽出したICDコード情報を戻り値として返す                                        
【3】Gr3グループ：処理済みのExcelファイルを指定パスに保存する                      

【使用変数】                                                                        
- excel：Excelファイルの参照を格納するグローバル変数                                
- icdコード：ICDコード情報を格納する型変数（ICD_10、対応コード、ICD分類名称、DPC傷病分類_DPC6桁を含む）</property>
```

**重要**：旧形式（XML形式）の場合、`<property name="comment">`要素には必ず`class="String"`属性を追加する必要があります。`class`属性がないと「Class name is missing for an object」エラーが発生します。

#### 新形式（Robot2形式、JSON body形式）の場合

**修正前（prologue内）：**
```xml
<comment/>
```

**修正前（JSON内）：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "" }
  }
}
```

**修正後（prologue内）：**
```xml
<comment>【ロボット概要】デスクトップ上のkintoneアイコンをダブルクリックしてシステムを起動するロボット                                  

【処理内容】デスクトップ上のkintoneアイコンを検索し、見つかった場合はダブルクリックしてシステムを起動する。60秒以内に見つからない場合はタイムアウトエラーをスローする。                          

【主な処理フロー】                                                                  
【1】条件分岐ステップ：デスクトップ上のkintoneアイコンを検索する                                
    - アイコンが見つかった場合：ダブルクリックを実行する                                                  
    - 60秒以内に見つからない場合：タイムアウトエラーをスローする                      
【2】戻り値ステップ：処理を終了して戻る                                                      

【使用変数】                                                                        
- txt：テキスト型のパラメータ（引数として使用）</comment>
```

**修正後（JSON内）：**
```json
"comment": {
  "meta":{
    "className":"Comment",
    "version":0
  },
  "gizmo":{
    "comment": { "string": "【ロボット概要】デスクトップ上のkintoneアイコンをダブルクリックしてシステムを起動するロボット                                  \n\n【処理内容】デスクトップ上のkintoneアイコンを検索し、見つかった場合はダブルクリックしてシステムを起動する。60秒以内に見つからない場合はタイムアウトエラーをスローする。                          \n\n【主な処理フロー】                                                                  \n【1】条件分岐ステップ：デスクトップ上のkintoneアイコンを検索する                                \n    - アイコンが見つかった場合：ダブルクリックを実行する                                                  \n    - 60秒以内に見つからない場合：タイムアウトエラーをスローする                      \n【2】戻り値ステップ：処理を終了して戻る                                                      \n\n【使用変数】                                                                        \n- txt：テキスト型のパラメータ（引数として使用）" }
  }
}
```

**注意**：JSON形式では改行は`\n`で表現し、XML形式と同じ内容を記述する。

### 文字数調整の方法
- 各行を51文字以内に収める
- 足りない場合は行末にスペースを追加して51文字に揃える
- 全角文字は2文字としてカウント、半角文字は1文字としてカウント

### チェックリスト
- [ ] `<prologue>`内の`<comment>`タグにコメントが追加されている
- [ ] 旧形式：`<property name="comment" class="String">`要素に同じ内容のコメントが追加されている（`class="String"`属性が必須）
- [ ] 新形式：JSON内の`"configurations"` → `"comment"`に同じ内容のコメントが追加されている
- [ ] 【ロボット概要】、【処理内容】、【主な処理フロー】、【使用変数】の4セクションがすべて含まれている
- [ ] 見出しは【】で囲まれている
- [ ] 項目番号は【】で囲まれている
- [ ] コロンは全角コロン（：）が使用されている
- [ ] 各行は51文字以内に収められている
- [ ] コメントは日本語で記載されている
- [ ] 新形式の場合、JSON内の改行は`\n`で表現されている

---

## 5. ロボットタグの追加

### 作業内容
ロボットタグ（`<tags>`タグと`<property name="tags">`）に、このロボットが使用しているリソース名をタグ付けする。

### 重要な注意点
- **処理内容ではなく、利用しているリソース名をタグとして記載する**
- システム名、Typeファイル名、スニペット名などを記載する

### ファイル形式による手順の違い

#### 旧形式（XML形式）の場合

1. ファイルの`<prologue>`内の`<tags>`タグを探す
2. `<property name="tags" class="RobotTagList">`要素を探す
3. 使用しているリソースを確認する：
   - `<browser-engine>`要素からブラウザエンジン名を取得（例：WEBKIT、CHROME）
   - `<referenced-types>`要素からTypeファイル名を取得
   - `<referenced-snippets>`要素からスニペット名を取得
4. 各リソース名を`<tag>`要素として追加する

#### 新形式（Robot2形式、JSON body形式）の場合

1. ファイルの`<prologue>`内の`<tags>`タグを探す（XML部分）
2. 使用しているリソースを確認する：
   - `<device-mappings>`要素からデバイス名を取得（例：DAS）
   - `<referenced-types>`要素からTypeファイル名を取得（旧形式と同じ）
   - `<sub-robots>`要素からサブロボット名を取得（使用している場合）
   - JSON内の`"hubMappings"`配列からハブ名を取得（例：DAS）
3. 各リソース名を`<prologue>`内の`<tags>`タグに追加する
4. **重要**：JSON内の`"tags"`配列（`"gizmo"` → `"configurations"` → `"gizmo"` → `"tags"`）は**空の配列（`[]`）のままにしておく**。`RobotTag`オブジェクトを追加するとエラーが発生する

### 修正例

#### 旧形式（XML形式）の場合

**修正前：**
```xml
<tags/>
```

**修正後：**
```xml
<tags>
  <tag>WEBKIT</tag>
  <tag>ICDコード</tag>
</tags>
```

**修正前：**
```xml
<property name="tags" class="RobotTagList"/>
```

**修正後：**
```xml
<property name="tags" class="RobotTagList">
  <object class="RobotTag">
    <property name="tag" class="String">WEBKIT</property>
  </object>
  <object class="RobotTag">
    <property name="tag" class="String">ICDコード</property>
  </object>
</property>
```

#### 新形式（Robot2形式、JSON body形式）の場合

**修正前（prologue内）：**
```xml
<tags/>
```

**修正前（JSON内）：**
```json
"tags": []
```

**修正後（prologue内）：**
```xml
<tags>
  <tag>DAS</tag>
</tags>
```

**修正後（JSON内）：**
```json
"tags": []
```

**重要**：新形式（Robot2形式）では、JSON内の`tags`配列は**空の配列（`[]`）のままにしておく必要があります**。`RobotTag`オブジェクトを追加すると、`DeserializerException: Unrecognized class 'RobotTag'`エラーが発生します。タグは`<prologue>`内の`<tags>`タグにのみ記述してください。

### タグの種類
- **システム名**：WEBKIT、CHROME、FIREFOXなど（旧形式）
- **デバイス名**：DASなど（新形式）
- **Typeファイル名**：var、customType、ICDコードなど（拡張子なし）
- **スニペット名**：使用しているスニペット名（使用している場合のみ）
- **サブロボット名**：使用しているサブロボット名（使用している場合のみ）

### チェックリスト
- [ ] `<prologue>`内の`<tags>`タグにタグが追加されている
- [ ] 旧形式：`<property name="tags">`要素に同じタグが追加されている
- [ ] 新形式：JSON内の`"tags"`配列は空の配列（`[]`）のままである（`RobotTag`オブジェクトを追加しない）
- [ ] タグはリソース名のみで、処理内容ではない
- [ ] 使用しているすべてのリソースがタグ付けされている

---

## 6. 最終確認とリンターエラー修正

### 確認項目
1. **XML形式・JSON形式の確認**
   - すべてのタグが正しく閉じられている（XML部分）
   - JSON形式が正しい（JSON部分）
   - 属性値が正しく引用符で囲まれている
   - 特殊文字がエスケープされている
   - JSON内の改行は`\n`で表現されている

2. **コメントの確認**
   - 旧形式：すべての`<null/>`が適切なコメントに置き換えられている
   - 新形式：すべての空文字列（`"string": ""`）が適切なコメントに置き換えられている
   - コメントは日本語で記載されている
   - 絵文字が使用されていない

3. **形式の確認**
   - Groupコメント（またはBlockコメント）は上段と下段のみが`*`で囲まれている
   - ロボット全体のコメントは【】で囲まれた見出しを使用している
   - 各行の文字数が51文字以内に収められている

4. **リンターエラーの確認**
   - リンターを実行してエラーがないことを確認する
   - エラーがある場合は修正する

### チェックリスト
- [ ] XML形式・JSON形式が正しい
- [ ] すべてのコメントが追加されている（旧形式・新形式の両方に対応）
- [ ] コメントの形式が正しい
- [ ] リンターエラーがない
- [ ] ファイルが削除されていない

---

## 注意事項（必ず守ること）

1. **すべてのコメントは日本語で記載する**
2. **プログラム内に絵文字は使用しない**
3. **ファイルの削除は行わない**
4. **既存のコメントスタイルを維持する**
5. **リンターエラーが発生しないように注意する**
6. **XML形式・JSON形式の構造を崩さない**
7. **既存のコメントがある場合は上書きしない**
8. **JSON形式では改行を`\n`で表現する**
9. **ファイル形式（旧形式・新形式）を正しく判定してから作業を開始する**
10. **旧形式（XML形式）の場合、`<property name="comment">`要素には必ず`class="String"`属性を追加する**（`class`属性がないと「Class name is missing for an object」エラーが発生する）
11. **AssignVariableステップのコメントには、変数名と型情報を必ず記載する**
12. **ファイル処理やページ読み込みステップのコメントには、ファイルパスやURLの取得方法（変数または直接指定）を必ず記載する**
13. **値が直接指定されている場合は、「直接ハードコードされている」旨を必ず記載する**
14. **キープレス（PressKeyStep）のアクションについては、「（キーは直接ハードコードされている）」は記載しない**
15. **GuardedChoiceStep内のブロック内ステップ（GuardAndBlock内のblock要素内のステップ）にも、必ずコメントを追加する**（空文字列のままにしない）
16. **GuardedChoiceStepでTreeStopsChangingGuardを使用している待機ステップには、必ずコメントを追加する**（空文字列のままにしない）。また、`milliseconds`フィールド内の`Expression`の`comment`にも待機時間の説明を記載する

---

## 作業の進め方

1. **ファイル全体を読み込む**：構造を理解し、ファイル形式（旧形式・新形式）を判定する
2. **Typeファイルを処理する**：各属性にコメントを追加（Typeファイルがある場合）
3. **ステップを処理する**：各ステップ（TransitionステップまたはJSON形式のステップ）にコメントを追加
4. **Groupステップ（またはBlockステップ）を処理する**：各グループにコメントを追加
5. **ロボット全体のコメントを追加する**：2箇所に同じ内容を追加（旧形式：XMLの2箇所、新形式：XMLとJSONの2箇所）
6. **タグを追加する**：2箇所に同じタグを追加（旧形式：XMLの2箇所、新形式：XMLとJSONの2箇所）
7. **リンターエラーを確認する**：エラーがあれば修正

各ステップを順番に実行し、チェックリストを確認しながら進めてください。
